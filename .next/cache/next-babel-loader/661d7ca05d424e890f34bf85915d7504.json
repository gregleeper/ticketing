{"ast":null,"code":"import _toConsumableArray from \"/Users/gregleeper/jds/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"/Users/gregleeper/jds/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/gregleeper/jds/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/gregleeper/jds/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/gregleeper/jds/pages/tickets/create.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { Formik, Field, Form } from \"formik\";\nimport { useRouter } from \"next/router\";\nimport { useState, useEffect } from \"react\";\nimport { FormikSelect } from \"../../components/formikSelectTickets\";\nimport Layout from \"../../components/layout\";\nimport { API } from \"aws-amplify\";\nimport { createTicket } from \"../../src/graphql/mutations.ts\";\nimport { listContracts } from \"../../src/graphql/queries.ts\";\nimport { ticketsByContract } from \"../../src/graphql/customQueries\";\nimport DatePicker from \"react-datepicker\";\nimport { truncateString } from \"../../utils\";\nimport { useQuery, useMutation, useQueryCache } from \"react-query\";\nimport { ReactQueryDevtools } from \"react-query-devtools\";\nimport { CreateTicketSchema } from \"../../components/validationSchema\";\n\nvar CreateTicket = function CreateTicket() {\n  _s();\n\n  var queryCache = useQueryCache();\n  var router = useRouter();\n\n  var _useState = useState([]),\n      contracts = _useState[0],\n      setContracts = _useState[1];\n\n  var _useState2 = useState([]),\n      correspondingContracts = _useState2[0],\n      setCorrespondingContracts = _useState2[1];\n\n  var _useState3 = useState(new Date()),\n      ticketDate = _useState3[0],\n      setTicketDate = _useState3[1];\n\n  var _useState4 = useState(false),\n      ticketSuccess1 = _useState4[0],\n      setTicketSuccess1 = _useState4[1];\n\n  var _useState5 = useState(false),\n      ticketSuccess2 = _useState5[0],\n      setTicketSuccess2 = _useState5[1];\n\n  var _useState6 = useState(null),\n      contractId = _useState6[0],\n      setContractId = _useState6[1];\n\n  var _useState7 = useState(null),\n      purchasedFromQtyRemaining = _useState7[0],\n      setPurchasedFromQuantityRemaining = _useState7[1];\n\n  var _useState8 = useState(null),\n      soldToQtyRemaining = _useState8[0],\n      setSoldToQuantityRemaining = _useState8[1];\n\n  var _useState9 = useState(null),\n      correspondingContractId = _useState9[0],\n      setCorrespondingContractId = _useState9[1];\n\n  var _useState10 = useState(null),\n      ticketError = _useState10[0],\n      setTicketError = _useState10[1];\n\n  var _useState11 = useState([]),\n      createdTickets = _useState11[0],\n      setCreatedTickets = _useState11[1];\n\n  var _useMutation = useMutation( /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(input) {\n      var _yield$API$graphql, ticketData;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return API.graphql({\n                query: createTicket,\n                variables: {\n                  input: input\n                }\n              });\n\n            case 2:\n              _yield$API$graphql = _context.sent;\n              ticketData = _yield$API$graphql.data;\n              return _context.abrupt(\"return\", ticketData);\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }(), {\n    onSuccess: function onSuccess(_ref2) {\n      var createTicket = _ref2.createTicket;\n\n      var ticketsCreated = _toConsumableArray(createdTickets);\n\n      ticketsCreated.push(createTicket);\n      setCreatedTickets(ticketsCreated);\n      var lengthOfGroups = queryCache.getQueryData(\"tickets\").length;\n      var previousData = queryCache.getQueryData(\"tickets\");\n      previousData[lengthOfGroups - 1].items.push(createTicket);\n      return function () {\n        return queryCache.setQueryData(\"tickets\", function () {\n          return [previousData];\n        });\n      };\n    },\n    onError: function onError(_ref3) {\n      var ticketError = _ref3.ticketError;\n      setTicketError(ticketError);\n    }\n  }),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      mutate = _useMutation2[0],\n      _useMutation2$ = _useMutation2[1],\n      data = _useMutation2$.data,\n      error = _useMutation2$.error,\n      isSuccess = _useMutation2$.isSuccess;\n\n  var _useQuery = useQuery(\"contracts\", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n    var _yield$API$graphql2, contractsData;\n\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return API.graphql({\n              query: listContracts,\n              variables: {\n                limit: 3000\n              }\n            });\n\n          case 2:\n            _yield$API$graphql2 = _context2.sent;\n            contractsData = _yield$API$graphql2.data.listContracts;\n            return _context2.abrupt(\"return\", contractsData);\n\n          case 5:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  })), {\n    cacheTime: 1000 * 60 * 20\n  }),\n      contractsData = _useQuery.data;\n\n  var getPurchasedFromTickets = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var _yield$API$graphql3, purchasedFromTickets, contractNumber, contractedQty, qtyRemaining, contract, myContract;\n\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return API.graphql({\n                query: ticketsByContract,\n                variables: {\n                  contractId: contractId,\n                  limit: 1000\n                }\n              });\n\n            case 2:\n              _yield$API$graphql3 = _context3.sent;\n              purchasedFromTickets = _yield$API$graphql3.data.ticketsByContract.items;\n\n              if (purchasedFromTickets.length > 0) {\n                contractNumber = purchasedFromTickets[0].contract.contractNumber;\n                contractedQty = purchasedFromTickets[0].contract.quantity;\n                qtyRemaining = contractedQty - purchasedFromTickets.reduce(function (acc, cv) {\n                  return acc + cv.netTons;\n                }, 0);\n                setPurchasedFromQuantityRemaining({\n                  contractNumber: contractNumber,\n                  contractedQty: contractedQty,\n                  qtyRemaining: qtyRemaining\n                });\n              } else {\n                contract = contractsData.items.findIndex(function (contract) {\n                  return contract.id === contractId;\n                });\n                myContract = contractsData.items[contract];\n                console.log(myContract);\n                setPurchasedFromQuantityRemaining({\n                  contractNumber: myContract.contractNumber,\n                  contractedQty: myContract.quantity,\n                  qtyRemaining: myContract.quantity\n                });\n              }\n\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function getPurchasedFromTickets() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var getSoldToTickets = /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      var _yield$API$graphql4, soldToTickets, contractNumber, contractedQty, qtyRemaining, contract, myContract;\n\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return API.graphql({\n                query: ticketsByContract,\n                variables: {\n                  contractId: correspondingContractId,\n                  limit: 1000\n                }\n              });\n\n            case 2:\n              _yield$API$graphql4 = _context4.sent;\n              soldToTickets = _yield$API$graphql4.data.ticketsByContract.items;\n\n              if (soldToTickets.length > 0) {\n                contractNumber = soldToTickets[0].contract.contractNumber;\n                contractedQty = soldToTickets[0].contract.quantity;\n                qtyRemaining = contractedQty - soldToTickets.reduce(function (acc, cv) {\n                  return acc + cv.netTons;\n                }, 0);\n                setSoldToQuantityRemaining({\n                  contractNumber: contractNumber,\n                  contractedQty: contractedQty,\n                  qtyRemaining: qtyRemaining\n                });\n              } else {\n                contract = contractsData.items.findIndex(function (contract) {\n                  return contract.id === correspondingContractId;\n                });\n                myContract = contractsData.items[contract];\n                console.log(myContract);\n                setSoldToQuantityRemaining({\n                  contractNumber: myContract.contractNumber,\n                  contractedQty: myContract.quantity,\n                  qtyRemaining: myContract.quantity\n                });\n              }\n\n            case 5:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function getSoldToTickets() {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  var handleContractIdChange = function handleContractIdChange(value) {\n    setContractId(value);\n  };\n\n  var handleCorrespondingContractIdChange = function handleCorrespondingContractIdChange(value) {\n    console.log(value);\n    setCorrespondingContractId(value);\n  };\n\n  useEffect(function () {\n    if (contractsData) {\n      var options = [];\n      contractsData.items.map(function (c) {\n        options.push({\n          value: c.id,\n          label: \"\".concat(c.contractNumber, \" - \").concat(c.contractTo.companyReportName, \" - \").concat(c.contractType)\n        });\n      });\n      setContracts(options);\n      setCorrespondingContracts(options);\n    }\n  }, [contractsData]);\n  useEffect(function () {\n    if (contractId) {\n      getPurchasedFromTickets();\n    }\n\n    if (correspondingContractId) {\n      getSoldToTickets();\n    }\n  }, [contractId, correspondingContractId]);\n  return __jsx(Layout, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    className: \"text-center w-1/2 mx-auto py-6 text-2xl font-bold\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 9\n    }\n  }, __jsx(\"h3\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 11\n    }\n  }, \"Create Ticket\")), __jsx(\"div\", {\n    className: \"flex justify-around relative \",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"w-1/2\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 11\n    }\n  }, __jsx(Formik, {\n    initialValues: {\n      contractId: \"\",\n      correspondingContractId: \"\",\n      ticketDate: ticketDate,\n      fieldNum: \"\",\n      baleCount: 0,\n      ticketNumber: \"\",\n      ladingNumber: \"\",\n      driver: \"\",\n      truckNumber: \"\",\n      grossWeight: 0,\n      tareWeight: 0,\n      netWeight: 0,\n      netTons: 0\n    },\n    validationSchema: CreateTicketSchema,\n    onSubmit: /*#__PURE__*/function () {\n      var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(values, actions) {\n        var netWeight, netTons, input1, input2;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                netWeight = values.grossWeight - values.tareWeight;\n                netTons = netWeight / 2000;\n                input1 = {\n                  contractId: values.contractId,\n                  correspondingContractId: values.correspondingContractId,\n                  ticketDate: ticketDate,\n                  fieldNum: values.fieldNum,\n                  baleCount: values.baleCount === \"\" ? null : values.baleCount,\n                  ticketNumber: values.ticketNumber,\n                  ladingNumber: values.ladingNumber,\n                  driver: values.driver,\n                  type: \"Ticket\",\n                  truckNumber: values.truckNumber,\n                  grossWeight: values.grossWeight,\n                  tareWeight: values.tareWeight,\n                  netWeight: netWeight,\n                  netTons: netTons\n                };\n\n                try {\n                  mutate(input1);\n                  setTicketSuccess1(true);\n                } catch (err) {\n                  if (err) {\n                    setTicketError(err);\n                  }\n                }\n\n                input2 = {\n                  contractId: values.correspondingContractId,\n                  correspondingContractId: values.contractId,\n                  ticketDate: ticketDate,\n                  fieldNum: values.fieldNum,\n                  baleCount: values.baleCount === \"\" ? null : values.baleCount,\n                  ticketNumber: values.ticketNumber,\n                  ladingNumber: values.ladingNumber,\n                  driver: values.driver,\n                  type: \"Ticket\",\n                  truckNumber: values.truckNumber,\n                  grossWeight: values.grossWeight,\n                  tareWeight: values.tareWeight,\n                  netWeight: netWeight,\n                  netTons: netTons\n                };\n\n                try {\n                  mutate(input2);\n                  setTicketSuccess2(true);\n                } catch (err) {\n                  if (err) {\n                    setTicketError(err);\n                  }\n                }\n\n                setTimeout(function () {\n                  setTicketSuccess1(false);\n                  setTicketSuccess2(false);\n                  setCorrespondingContractId(null);\n                  setContractId(null);\n                }, 2000);\n                actions.resetForm();\n\n              case 8:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5);\n      }));\n\n      return function (_x2, _x3) {\n        return _ref7.apply(this, arguments);\n      };\n    }(),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 13\n    }\n  }, function (_ref8) {\n    var isSubmitting = _ref8.isSubmitting,\n        errors = _ref8.errors,\n        touched = _ref8.touched,\n        values = _ref8.values;\n    return __jsx(Form, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 17\n      }\n    }, __jsx(\"div\", {\n      className: \"w-full mx-auto\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 19\n      }\n    }, __jsx(\"div\", {\n      className: \"flex justify-between items-center mb-4\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 21\n      }\n    }, __jsx(\"label\", {\n      className: \"text-gray-900 w-1/4 md:w-1/2\",\n      htmlFor: \"ticketNumber\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281,\n        columnNumber: 23\n      }\n    }, \"Ticket Number\"), __jsx(Field, {\n      className: \"form-input w-full\",\n      name: \"ticketNumber\",\n      placeholder: \"Ticket Number\",\n      autoComplete: \"on\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 23\n      }\n    }), errors.ticketNumber && touched.ticketNumber ? __jsx(\"div\", {\n      className: \"text-red-700 ml-2 bg-red-200 px-2 py-1 rounded-sm\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 25\n      }\n    }, errors.ticketNumber) : null), __jsx(\"div\", {\n      className: \"flex justify-between items-center mb-4\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 21\n      }\n    }, __jsx(\"label\", {\n      className: \"text-gray-900 w-1/4 md:w-1/2\",\n      htmlFor: \"contractId\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 23\n      }\n    }, \"Contract Number - Purchased From\"), __jsx(Field, {\n      className: \"form-select w-full\",\n      component: FormikSelect,\n      options: contracts,\n      name: \"contractId\",\n      handleChange: handleContractIdChange,\n      placeholder: \"Contract Number\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 23\n      }\n    }), errors.contractId && touched.contractId ? __jsx(\"div\", {\n      className: \"text-red-700 ml-2 bg-red-200 px-2 py-1 rounded-sm\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 25\n      }\n    }, errors.contractId) : null), __jsx(\"div\", {\n      className: \"flex justify-between items-center mb-4\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 21\n      }\n    }, __jsx(\"label\", {\n      className: \"text-gray-900 w-1/4 md:w-1/2\",\n      htmlFor: \"correspondingContractId\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 321,\n        columnNumber: 23\n      }\n    }, \"Corresponding Contract Number - Sold To\"), __jsx(Field, {\n      className: \"form-select w-full\",\n      component: FormikSelect,\n      options: correspondingContracts,\n      handleChange: handleCorrespondingContractIdChange,\n      name: \"correspondingContractId\",\n      placeholder: \"Contract Number\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 23\n      }\n    }), errors.correspondingContractId && touched.correspondingContractId ? __jsx(\"div\", {\n      className: \"text-red-700 ml-2 bg-red-200 px-2 py-1 rounded-sm\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 25\n      }\n    }, errors.correspondingContractId) : null), __jsx(\"div\", {\n      className: \"flex justify-between items-center mb-4\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 21\n      }\n    }, __jsx(\"label\", {\n      className: \"text-gray-900 w-1/4 md:w-1/2\",\n      htmlFor: \"ticketDate\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 23\n      }\n    }, \"Ticket Date\"), __jsx(DatePicker, {\n      selected: ticketDate,\n      onChange: function onChange(date) {\n        console.log(date), setTicketDate(date);\n      },\n      className: \"form-input w-full\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 349,\n        columnNumber: 23\n      }\n    })), __jsx(\"div\", {\n      className: \"flex justify-between items-center mb-4\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 358,\n        columnNumber: 21\n      }\n    }, __jsx(\"label\", {\n      className: \"text-gray-900 w-1/4 md:w-1/2\",\n      htmlFor: \"fieldNum\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 359,\n        columnNumber: 23\n      }\n    }, \"Field Number\"), __jsx(Field, {\n      className: \"form-input w-full\",\n      name: \"fieldNum\",\n      placeholder: \"Field Number\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 366,\n        columnNumber: 23\n      }\n    }), errors.fieldNum && touched.fieldNum ? __jsx(\"div\", {\n      className: \"text-red-700 ml-2 bg-red-200 px-2 py-1 rounded-sm\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 25\n      }\n    }, errors.fieldNum) : null), __jsx(\"div\", {\n      className: \"flex justify-between items-center mb-4\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 377,\n        columnNumber: 21\n      }\n    }, __jsx(\"label\", {\n      className: \"text-gray-900 w-1/4 md:w-1/2\",\n      htmlFor: \"baleCount\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 378,\n        columnNumber: 23\n      }\n    }, \"Bale Count\"), __jsx(Field, {\n      className: \"form-input w-full\",\n      name: \"baleCount\",\n      placeholder: \"Bale Count\",\n      type: \"number\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 385,\n        columnNumber: 23\n      }\n    })), __jsx(\"div\", {\n      className: \"flex justify-between items-center mb-4 w-full\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 392,\n        columnNumber: 21\n      }\n    }, __jsx(\"label\", {\n      className: \"text-gray-900 w-1/4 md:w-1/2 pr-4\",\n      name: \"ladingNumber\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 393,\n        columnNumber: 23\n      }\n    }, \"Lading Number\"), __jsx(Field, {\n      className: \"form-input w-full\",\n      name: \"ladingNumber\",\n      placeholder: \"Lading Number\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 399,\n        columnNumber: 23\n      }\n    }), errors.ladingNumber && touched.ladingNumber ? __jsx(\"div\", {\n      className: \"text-red-700 ml-2 bg-red-200 px-2 py-1 rounded-sm\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 405,\n        columnNumber: 25\n      }\n    }, errors.ladingNumber) : null), __jsx(\"div\", {\n      className: \"flex justify-between items-center mb-4\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 21\n      }\n    }, __jsx(\"label\", {\n      className: \"w-1/4 text-gray-900 md:w-1/2\",\n      htmlFor: \"driver\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 411,\n        columnNumber: 23\n      }\n    }, \"Driver\"), __jsx(Field, {\n      className: \"form-input w-full\",\n      name: \"driver\",\n      placeholder: \"Driver\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 417,\n        columnNumber: 23\n      }\n    }), errors.drivers && touched.drivers ? __jsx(\"div\", {\n      className: \"text-red-700 ml-2 bg-red-200 px-2 py-1 rounded-sm\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 423,\n        columnNumber: 25\n      }\n    }, errors.drivers) : null), __jsx(\"div\", {\n      className: \"flex justify-between items-center mb-4\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 428,\n        columnNumber: 21\n      }\n    }, __jsx(\"label\", {\n      className: \"w-1/4 text-gray-900 md:w-1/2\",\n      htmlFor: \"truckNumber\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 429,\n        columnNumber: 23\n      }\n    }, \"Truck Number\"), __jsx(Field, {\n      className: \"form-input w-full\",\n      name: \"truckNumber\",\n      placeholder: \"Truck Number\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 23\n      }\n    }), errors.truckNumber && touched.truckNumber ? __jsx(\"div\", {\n      className: \"text-red-700 ml-2 bg-red-200 px-2 py-1 rounded-sm\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 441,\n        columnNumber: 25\n      }\n    }, errors.truckNumber) : null), __jsx(\"div\", {\n      className: \"flex justify-between items-center mb-4\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 446,\n        columnNumber: 21\n      }\n    }, __jsx(\"label\", {\n      className: \"w-1/4 text-gray-900 md:w-1/2\",\n      htmlFor: \"grossWeight\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 447,\n        columnNumber: 23\n      }\n    }, \"Gross Weight\"), __jsx(Field, {\n      className: \"form-input w-full\",\n      name: \"grossWeight\",\n      type: \"number\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 453,\n        columnNumber: 23\n      }\n    }), errors.grossWeight && touched.grossWeight ? __jsx(\"div\", {\n      className: \"text-red-700 ml-2 bg-red-200 px-2 py-1 rounded-sm\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 459,\n        columnNumber: 25\n      }\n    }, errors.grossWeight) : null), __jsx(\"div\", {\n      className: \"flex justify-between items-center mb-4\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 464,\n        columnNumber: 21\n      }\n    }, __jsx(\"label\", {\n      className: \"w-1/4 text-gray-900 md:w-1/2\",\n      htmlFor: \"tareWeight\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 465,\n        columnNumber: 23\n      }\n    }, \"Tare Weight\"), __jsx(Field, {\n      className: \"form-input w-full\",\n      name: \"tareWeight\",\n      type: \"number\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 471,\n        columnNumber: 23\n      }\n    }), errors.tareWeight && touched.tareWeight ? __jsx(\"div\", {\n      className: \"text-red-700 ml-2 bg-red-200 px-2 py-1 rounded-sm\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 477,\n        columnNumber: 25\n      }\n    }, errors.tareWeight) : null), __jsx(\"div\", {\n      className: \"flex justify-between items-center mb-4\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 482,\n        columnNumber: 21\n      }\n    }, __jsx(\"label\", {\n      className: \"w-1/4 text-gray-900 md:w-1/2\",\n      htmlFor: \"netWeight\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 483,\n        columnNumber: 23\n      }\n    }, \"Net Weight\"), __jsx(\"div\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 489,\n        columnNumber: 23\n      }\n    }, __jsx(\"span\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 490,\n        columnNumber: 25\n      }\n    }, values.grossWeight && values.tareWeight ? (values.grossWeight - values.tareWeight).toFixed(2) : \"Not calculated\"))), __jsx(\"div\", {\n      className: \"flex justify-between items-center mb-4\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 499,\n        columnNumber: 21\n      }\n    }, __jsx(\"label\", {\n      className: \"w-1/4 text-gray-900 md:w-1/2\",\n      htmlFor: \"netTons\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 500,\n        columnNumber: 23\n      }\n    }, \"Net Tons\"), __jsx(\"div\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 506,\n        columnNumber: 23\n      }\n    }, __jsx(\"span\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 507,\n        columnNumber: 25\n      }\n    }, values.grossWeight && values.tareWeight ? ((values.grossWeight - values.tareWeight) / 2000).toFixed(2) : \"Not calculated\"))), __jsx(\"div\", {\n      className: \"flex justify-center mt-12\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 518,\n        columnNumber: 21\n      }\n    }, __jsx(\"button\", {\n      className: \"px-3 py-2 border border-red-500 shadow hover:bg-red-500 hover:text-white mr-12\",\n      onClick: function onClick() {\n        return router.back();\n      },\n      type: \"button\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 519,\n        columnNumber: 23\n      }\n    }, \"Cancel\"), __jsx(\"button\", {\n      className: \"px-3 py-2 border border-gray-800 shadow hover:bg-gray-800 hover:text-white disabled:opacity-25\",\n      type: \"submit\",\n      disabled: isSubmitting || purchasedFromQtyRemaining && purchasedFromQtyRemaining.qtyRemaining <= 0 || soldToQtyRemaining && soldToQtyRemaining.qtyRemaining < 0.01,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 526,\n        columnNumber: 23\n      }\n    }, \"Submit\"))));\n  }), ticketError ? __jsx(\"div\", {\n    className: \"bg-red-600 text-white\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 545,\n      columnNumber: 15\n    }\n  }, console.log(ticketError)) : __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 549,\n      columnNumber: 15\n    }\n  }), ticketSuccess1 && ticketSuccess2 ? __jsx(\"div\", {\n    className: \"absolute inset-0 flex items-center justify-center \",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 552,\n      columnNumber: 15\n    }\n  }, __jsx(\"div\", {\n    className: \" w-64 h-24 text-white bg-green-500 bg-opacity-75 py-8\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 553,\n      columnNumber: 17\n    }\n  }, __jsx(\"span\", {\n    className: \"px-4\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 554,\n      columnNumber: 19\n    }\n  }, \"Successfully created ticet.\"))) : __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 558,\n      columnNumber: 15\n    }\n  })), __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 561,\n      columnNumber: 11\n    }\n  }, __jsx(\"div\", {\n    className: \"w-2/12\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 562,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"border-b-4 w-full border-gray-600 mb-3 text-center\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 563,\n      columnNumber: 15\n    }\n  }, __jsx(\"h6\", {\n    className: \"text-gray-900 text-lg\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 564,\n      columnNumber: 17\n    }\n  }, \"Created Tickets\")), __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 566,\n      columnNumber: 15\n    }\n  }, __jsx(\"ul\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 567,\n      columnNumber: 17\n    }\n  }, createdTickets.length ? createdTickets.map(function (ticket) {\n    return __jsx(\"li\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 570,\n        columnNumber: 23\n      }\n    }, \"\".concat(truncateString(ticket.id, 7), \" - \").concat(ticket.ticketNumber));\n  }) : __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 575,\n      columnNumber: 21\n    }\n  }, \"0\")))), __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 580,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"mt-8 border-b-4 border-gray-600 mb-2\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 581,\n      columnNumber: 15\n    }\n  }, __jsx(\"h6\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 582,\n      columnNumber: 17\n    }\n  }, \"Chosen Contract Values\")), purchasedFromQtyRemaining ? __jsx(\"div\", {\n    className: \"bg-blue-300 bg-opacity-50 px-2 py-2\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 585,\n      columnNumber: 17\n    }\n  }, __jsx(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 586,\n      columnNumber: 19\n    }\n  }, \"Purchased From:\"), __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 587,\n      columnNumber: 19\n    }\n  }, __jsx(\"span\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 588,\n      columnNumber: 21\n    }\n  }, purchasedFromQtyRemaining.contractNumber)), __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 590,\n      columnNumber: 19\n    }\n  }, __jsx(\"span\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 591,\n      columnNumber: 21\n    }\n  }, \"Contract Qty: \"), __jsx(\"span\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 592,\n      columnNumber: 21\n    }\n  }, purchasedFromQtyRemaining.contractedQty)), __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 594,\n      columnNumber: 19\n    }\n  }, __jsx(\"span\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 595,\n      columnNumber: 21\n    }\n  }, \"Qty Remaining: \"), __jsx(\"span\", {\n    className: \"\".concat(purchasedFromQtyRemaining.qtyRemaining < 25 ? \"text-red-500\" : \"text-gray-900\"),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 596,\n      columnNumber: 21\n    }\n  }, purchasedFromQtyRemaining.qtyRemaining.toFixed(2)))) : null, soldToQtyRemaining ? __jsx(\"div\", {\n    className: \"bg-green-300 bg-opacity-50 px-2 py-2 mt-2\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 609,\n      columnNumber: 17\n    }\n  }, __jsx(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 610,\n      columnNumber: 19\n    }\n  }, \"Sold To:\"), __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 611,\n      columnNumber: 19\n    }\n  }, __jsx(\"span\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 612,\n      columnNumber: 21\n    }\n  }, soldToQtyRemaining.contractNumber)), __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 614,\n      columnNumber: 19\n    }\n  }, __jsx(\"span\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 615,\n      columnNumber: 21\n    }\n  }, \"Contract Qty: \"), __jsx(\"span\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 616,\n      columnNumber: 21\n    }\n  }, soldToQtyRemaining.contractedQty)), __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 618,\n      columnNumber: 19\n    }\n  }, __jsx(\"span\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 619,\n      columnNumber: 21\n    }\n  }, \"Qty Remaining: \"), __jsx(\"span\", {\n    className: \"\".concat(soldToQtyRemaining.qtyRemaining < 25 ? \"text-red-500\" : \"text-gray-900\"),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 620,\n      columnNumber: 21\n    }\n  }, soldToQtyRemaining.qtyRemaining.toFixed(2)))) : null)))), __jsx(ReactQueryDevtools, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 636,\n      columnNumber: 7\n    }\n  }));\n};\n\n_s(CreateTicket, \"3fPBK7+O1mT+d3aXL93oZb7XeiQ=\", false, function () {\n  return [useQueryCache, useRouter, useMutation, useQuery];\n});\n\n_c = CreateTicket;\nexport var __N_SSP = true;\nexport default CreateTicket;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreateTicket\");","map":{"version":3,"sources":["/Users/gregleeper/jds/pages/tickets/create.js"],"names":["Formik","Field","Form","useRouter","useState","useEffect","FormikSelect","Layout","API","createTicket","listContracts","ticketsByContract","DatePicker","truncateString","useQuery","useMutation","useQueryCache","ReactQueryDevtools","CreateTicketSchema","CreateTicket","queryCache","router","contracts","setContracts","correspondingContracts","setCorrespondingContracts","Date","ticketDate","setTicketDate","ticketSuccess1","setTicketSuccess1","ticketSuccess2","setTicketSuccess2","contractId","setContractId","purchasedFromQtyRemaining","setPurchasedFromQuantityRemaining","soldToQtyRemaining","setSoldToQuantityRemaining","correspondingContractId","setCorrespondingContractId","ticketError","setTicketError","createdTickets","setCreatedTickets","input","graphql","query","variables","ticketData","data","onSuccess","ticketsCreated","push","lengthOfGroups","getQueryData","length","previousData","items","setQueryData","onError","mutate","error","isSuccess","limit","contractsData","cacheTime","getPurchasedFromTickets","purchasedFromTickets","contractNumber","contract","contractedQty","quantity","qtyRemaining","reduce","acc","cv","netTons","findIndex","id","myContract","console","log","getSoldToTickets","soldToTickets","handleContractIdChange","value","handleCorrespondingContractIdChange","options","map","c","label","contractTo","companyReportName","contractType","fieldNum","baleCount","ticketNumber","ladingNumber","driver","truckNumber","grossWeight","tareWeight","netWeight","values","actions","input1","type","err","input2","setTimeout","resetForm","isSubmitting","errors","touched","date","drivers","toFixed","back","ticket"],"mappings":";;;;;;;;;;;AAAA,SAASA,MAAT,EAAiBC,KAAjB,EAAwBC,IAAxB,QAAoC,QAApC;AACA,SAASC,SAAT,QAA0B,aAA1B;AACA,SAASC,QAAT,EAAmBC,SAAnB,QAAoC,OAApC;AACA,SAASC,YAAT,QAA6B,sCAA7B;AACA,OAAOC,MAAP,MAAmB,yBAAnB;AACA,SAASC,GAAT,QAAoC,aAApC;AACA,SAASC,YAAT,QAA6B,gCAA7B;AACA,SAASC,aAAT,QAA8B,8BAA9B;AACA,SAASC,iBAAT,QAAkC,iCAAlC;AACA,OAAOC,UAAP,MAAuB,kBAAvB;AACA,SAASC,cAAT,QAA+B,aAA/B;AACA,SAASC,QAAT,EAAmBC,WAAnB,EAAgCC,aAAhC,QAAqD,aAArD;AACA,SAASC,kBAAT,QAAmC,sBAAnC;AACA,SAASC,kBAAT,QAAmC,mCAAnC;;AAEA,IAAMC,YAAY,GAAG,SAAfA,YAAe,GAAM;AAAA;;AACzB,MAAMC,UAAU,GAAGJ,aAAa,EAAhC;AACA,MAAMK,MAAM,GAAGlB,SAAS,EAAxB;;AAFyB,kBAGSC,QAAQ,CAAC,EAAD,CAHjB;AAAA,MAGlBkB,SAHkB;AAAA,MAGPC,YAHO;;AAAA,mBAImCnB,QAAQ,CAAC,EAAD,CAJ3C;AAAA,MAIlBoB,sBAJkB;AAAA,MAIMC,yBAJN;;AAAA,mBAKWrB,QAAQ,CAAC,IAAIsB,IAAJ,EAAD,CALnB;AAAA,MAKlBC,UALkB;AAAA,MAKNC,aALM;;AAAA,mBAMmBxB,QAAQ,CAAC,KAAD,CAN3B;AAAA,MAMlByB,cANkB;AAAA,MAMFC,iBANE;;AAAA,mBAOmB1B,QAAQ,CAAC,KAAD,CAP3B;AAAA,MAOlB2B,cAPkB;AAAA,MAOFC,iBAPE;;AAAA,mBAQW5B,QAAQ,CAAC,IAAD,CARnB;AAAA,MAQlB6B,UARkB;AAAA,MAQNC,aARM;;AAAA,mBAYrB9B,QAAQ,CAAC,IAAD,CAZa;AAAA,MAUvB+B,yBAVuB;AAAA,MAWvBC,iCAXuB;;AAAA,mBAagChC,QAAQ,CAAC,IAAD,CAbxC;AAAA,MAalBiC,kBAbkB;AAAA,MAaEC,0BAbF;;AAAA,mBAcqClC,QAAQ,CAAC,IAAD,CAd7C;AAAA,MAclBmC,uBAdkB;AAAA,MAcOC,0BAdP;;AAAA,oBAeapC,QAAQ,CAAC,IAAD,CAfrB;AAAA,MAelBqC,WAfkB;AAAA,MAeLC,cAfK;;AAAA,oBAiBmBtC,QAAQ,CAAC,EAAD,CAjB3B;AAAA,MAiBlBuC,cAjBkB;AAAA,MAiBFC,iBAjBE;;AAAA,qBAmBoB7B,WAAW;AAAA,wEACtD,iBAAO8B,KAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACqCrC,GAAG,CAACsC,OAAJ,CAAY;AAC7CC,gBAAAA,KAAK,EAAEtC,YADsC;AAE7CuC,gBAAAA,SAAS,EAAE;AACTH,kBAAAA,KAAK,EAALA;AADS;AAFkC,eAAZ,CADrC;;AAAA;AAAA;AACgBI,cAAAA,UADhB,sBACUC,IADV;AAAA,+CAOSD,UAPT;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADsD;;AAAA;AAAA;AAAA;AAAA,OAUtD;AACEE,IAAAA,SAAS,EAAE,0BAAsB;AAAA,UAAnB1C,YAAmB,SAAnBA,YAAmB;;AAC/B,UAAI2C,cAAc,sBAAOT,cAAP,CAAlB;;AACAS,MAAAA,cAAc,CAACC,IAAf,CAAoB5C,YAApB;AAEAmC,MAAAA,iBAAiB,CAACQ,cAAD,CAAjB;AACA,UAAME,cAAc,GAAGlC,UAAU,CAACmC,YAAX,CAAwB,SAAxB,EAAmCC,MAA1D;AAEA,UAAIC,YAAY,GAAGrC,UAAU,CAACmC,YAAX,CAAwB,SAAxB,CAAnB;AACAE,MAAAA,YAAY,CAACH,cAAc,GAAG,CAAlB,CAAZ,CAAiCI,KAAjC,CAAuCL,IAAvC,CAA4C5C,YAA5C;AACA,aAAO;AAAA,eAAMW,UAAU,CAACuC,YAAX,CAAwB,SAAxB,EAAmC;AAAA,iBAAM,CAACF,YAAD,CAAN;AAAA,SAAnC,CAAN;AAAA,OAAP;AACD,KAXH;AAYEG,IAAAA,OAAO,EAAE,wBAAqB;AAAA,UAAlBnB,WAAkB,SAAlBA,WAAkB;AAC5BC,MAAAA,cAAc,CAACD,WAAD,CAAd;AACD;AAdH,GAVsD,CAnB/B;AAAA;AAAA,MAmBlBoB,MAnBkB;AAAA;AAAA,MAmBRX,IAnBQ,kBAmBRA,IAnBQ;AAAA,MAmBFY,KAnBE,kBAmBFA,KAnBE;AAAA,MAmBKC,SAnBL,kBAmBKA,SAnBL;;AAAA,kBA+COjD,QAAQ,CACtC,WADsC,wEAEtC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAGYN,GAAG,CAACsC,OAAJ,CAAY;AACpBC,cAAAA,KAAK,EAAErC,aADa;AAEpBsC,cAAAA,SAAS,EAAE;AACTgB,gBAAAA,KAAK,EAAE;AADE;AAFS,aAAZ,CAHZ;;AAAA;AAAA;AAE2BC,YAAAA,aAF3B,uBAEIf,IAFJ,CAEYxC,aAFZ;AAAA,8CASSuD,aATT;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAFsC,IAatC;AACEC,IAAAA,SAAS,EAAE,OAAO,EAAP,GAAY;AADzB,GAbsC,CA/Cf;AAAA,MA+CXD,aA/CW,aA+CjBf,IA/CiB;;AAiEzB,MAAMiB,uBAAuB;AAAA,yEAAG;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAKpB3D,GAAG,CAACsC,OAAJ,CAAY;AACpBC,gBAAAA,KAAK,EAAEpC,iBADa;AAEpBqC,gBAAAA,SAAS,EAAE;AACTf,kBAAAA,UAAU,EAAVA,UADS;AAET+B,kBAAAA,KAAK,EAAE;AAFE;AAFS,eAAZ,CALoB;;AAAA;AAAA;AAGEI,cAAAA,oBAHF,uBAE5BlB,IAF4B,CAG1BvC,iBAH0B,CAGL+C,KAHK;;AAY9B,kBAAIU,oBAAoB,CAACZ,MAArB,GAA8B,CAAlC,EAAqC;AAC7Ba,gBAAAA,cAD6B,GACZD,oBAAoB,CAAC,CAAD,CAApB,CAAwBE,QAAxB,CAAiCD,cADrB;AAE7BE,gBAAAA,aAF6B,GAEbH,oBAAoB,CAAC,CAAD,CAApB,CAAwBE,QAAxB,CAAiCE,QAFpB;AAG7BC,gBAAAA,YAH6B,GAIjCF,aAAa,GACbH,oBAAoB,CAACM,MAArB,CAA4B,UAACC,GAAD,EAAMC,EAAN;AAAA,yBAAaD,GAAG,GAAGC,EAAE,CAACC,OAAtB;AAAA,iBAA5B,EAA2D,CAA3D,CALiC;AAOnCzC,gBAAAA,iCAAiC,CAAC;AAChCiC,kBAAAA,cAAc,EAAdA,cADgC;AAEhCE,kBAAAA,aAAa,EAAbA,aAFgC;AAGhCE,kBAAAA,YAAY,EAAZA;AAHgC,iBAAD,CAAjC;AAKD,eAZD,MAYO;AACCH,gBAAAA,QADD,GACYL,aAAa,CAACP,KAAd,CAAoBoB,SAApB,CACf,UAACR,QAAD;AAAA,yBAAcA,QAAQ,CAACS,EAAT,KAAgB9C,UAA9B;AAAA,iBADe,CADZ;AAIC+C,gBAAAA,UAJD,GAIcf,aAAa,CAACP,KAAd,CAAoBY,QAApB,CAJd;AAKLW,gBAAAA,OAAO,CAACC,GAAR,CAAYF,UAAZ;AACA5C,gBAAAA,iCAAiC,CAAC;AAChCiC,kBAAAA,cAAc,EAAEW,UAAU,CAACX,cADK;AAEhCE,kBAAAA,aAAa,EAAES,UAAU,CAACR,QAFM;AAGhCC,kBAAAA,YAAY,EAAEO,UAAU,CAACR;AAHO,iBAAD,CAAjC;AAKD;;AAnC6B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAvBL,uBAAuB;AAAA;AAAA;AAAA,KAA7B;;AAsCA,MAAMgB,gBAAgB;AAAA,yEAAG;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAKb3E,GAAG,CAACsC,OAAJ,CAAY;AACpBC,gBAAAA,KAAK,EAAEpC,iBADa;AAEpBqC,gBAAAA,SAAS,EAAE;AACTf,kBAAAA,UAAU,EAAEM,uBADH;AAETyB,kBAAAA,KAAK,EAAE;AAFE;AAFS,eAAZ,CALa;;AAAA;AAAA;AAGSoB,cAAAA,aAHT,uBAErBlC,IAFqB,CAGnBvC,iBAHmB,CAGE+C,KAHF;;AAavB,kBAAI0B,aAAa,CAAC5B,MAAd,GAAuB,CAA3B,EAA8B;AACtBa,gBAAAA,cADsB,GACLe,aAAa,CAAC,CAAD,CAAb,CAAiBd,QAAjB,CAA0BD,cADrB;AAEtBE,gBAAAA,aAFsB,GAENa,aAAa,CAAC,CAAD,CAAb,CAAiBd,QAAjB,CAA0BE,QAFpB;AAGtBC,gBAAAA,YAHsB,GAI1BF,aAAa,GAAGa,aAAa,CAACV,MAAd,CAAqB,UAACC,GAAD,EAAMC,EAAN;AAAA,yBAAaD,GAAG,GAAGC,EAAE,CAACC,OAAtB;AAAA,iBAArB,EAAoD,CAApD,CAJU;AAM5BvC,gBAAAA,0BAA0B,CAAC;AACzB+B,kBAAAA,cAAc,EAAdA,cADyB;AAEzBE,kBAAAA,aAAa,EAAbA,aAFyB;AAGzBE,kBAAAA,YAAY,EAAZA;AAHyB,iBAAD,CAA1B;AAKD,eAXD,MAWO;AACCH,gBAAAA,QADD,GACYL,aAAa,CAACP,KAAd,CAAoBoB,SAApB,CACf,UAACR,QAAD;AAAA,yBAAcA,QAAQ,CAACS,EAAT,KAAgBxC,uBAA9B;AAAA,iBADe,CADZ;AAICyC,gBAAAA,UAJD,GAIcf,aAAa,CAACP,KAAd,CAAoBY,QAApB,CAJd;AAKLW,gBAAAA,OAAO,CAACC,GAAR,CAAYF,UAAZ;AACA1C,gBAAAA,0BAA0B,CAAC;AACzB+B,kBAAAA,cAAc,EAAEW,UAAU,CAACX,cADF;AAEzBE,kBAAAA,aAAa,EAAES,UAAU,CAACR,QAFD;AAGzBC,kBAAAA,YAAY,EAAEO,UAAU,CAACR;AAHA,iBAAD,CAA1B;AAKD;;AAnCsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAhBW,gBAAgB;AAAA;AAAA;AAAA,KAAtB;;AAsCA,MAAME,sBAAsB,GAAG,SAAzBA,sBAAyB,CAACC,KAAD,EAAW;AACxCpD,IAAAA,aAAa,CAACoD,KAAD,CAAb;AACD,GAFD;;AAIA,MAAMC,mCAAmC,GAAG,SAAtCA,mCAAsC,CAACD,KAAD,EAAW;AACrDL,IAAAA,OAAO,CAACC,GAAR,CAAYI,KAAZ;AACA9C,IAAAA,0BAA0B,CAAC8C,KAAD,CAA1B;AACD,GAHD;;AAKAjF,EAAAA,SAAS,CAAC,YAAM;AACd,QAAI4D,aAAJ,EAAmB;AACjB,UAAIuB,OAAO,GAAG,EAAd;AACAvB,MAAAA,aAAa,CAACP,KAAd,CAAoB+B,GAApB,CAAwB,UAACC,CAAD,EAAO;AAC7BF,QAAAA,OAAO,CAACnC,IAAR,CAAa;AACXiC,UAAAA,KAAK,EAAEI,CAAC,CAACX,EADE;AAEXY,UAAAA,KAAK,YAAKD,CAAC,CAACrB,cAAP,gBAA2BqB,CAAC,CAACE,UAAF,CAAaC,iBAAxC,gBAA+DH,CAAC,CAACI,YAAjE;AAFM,SAAb;AAID,OALD;AAMAvE,MAAAA,YAAY,CAACiE,OAAD,CAAZ;AACA/D,MAAAA,yBAAyB,CAAC+D,OAAD,CAAzB;AACD;AACF,GAZQ,EAYN,CAACvB,aAAD,CAZM,CAAT;AAcA5D,EAAAA,SAAS,CAAC,YAAM;AACd,QAAI4B,UAAJ,EAAgB;AACdkC,MAAAA,uBAAuB;AACxB;;AACD,QAAI5B,uBAAJ,EAA6B;AAC3B4C,MAAAA,gBAAgB;AACjB;AACF,GAPQ,EAON,CAAClD,UAAD,EAAaM,uBAAb,CAPM,CAAT;AASA,SACE,MAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAK,IAAA,SAAS,EAAC,mDAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADF,CADF,EAIE;AAAK,IAAA,SAAS,EAAC,+BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAK,IAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,MAAD;AACE,IAAA,aAAa,EAAE;AACbN,MAAAA,UAAU,EAAE,EADC;AAEbM,MAAAA,uBAAuB,EAAE,EAFZ;AAGbZ,MAAAA,UAAU,EAAEA,UAHC;AAIboE,MAAAA,QAAQ,EAAE,EAJG;AAKbC,MAAAA,SAAS,EAAE,CALE;AAMbC,MAAAA,YAAY,EAAE,EAND;AAObC,MAAAA,YAAY,EAAE,EAPD;AAQbC,MAAAA,MAAM,EAAE,EARK;AASbC,MAAAA,WAAW,EAAE,EATA;AAUbC,MAAAA,WAAW,EAAE,CAVA;AAWbC,MAAAA,UAAU,EAAE,CAXC;AAYbC,MAAAA,SAAS,EAAE,CAZE;AAab1B,MAAAA,OAAO,EAAE;AAbI,KADjB;AAgBE,IAAA,gBAAgB,EAAE3D,kBAhBpB;AAiBE,IAAA,QAAQ;AAAA,2EAAE,kBAAOsF,MAAP,EAAeC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AACJF,gBAAAA,SADI,GACQC,MAAM,CAACH,WAAP,GAAqBG,MAAM,CAACF,UADpC;AAEJzB,gBAAAA,OAFI,GAEM0B,SAAS,GAAG,IAFlB;AAIFG,gBAAAA,MAJE,GAIO;AACbzE,kBAAAA,UAAU,EAAEuE,MAAM,CAACvE,UADN;AAEbM,kBAAAA,uBAAuB,EAAEiE,MAAM,CAACjE,uBAFnB;AAGbZ,kBAAAA,UAAU,EAAEA,UAHC;AAIboE,kBAAAA,QAAQ,EAAES,MAAM,CAACT,QAJJ;AAKbC,kBAAAA,SAAS,EAAEQ,MAAM,CAACR,SAAP,KAAqB,EAArB,GAA0B,IAA1B,GAAiCQ,MAAM,CAACR,SALtC;AAMbC,kBAAAA,YAAY,EAAEO,MAAM,CAACP,YANR;AAObC,kBAAAA,YAAY,EAAEM,MAAM,CAACN,YAPR;AAQbC,kBAAAA,MAAM,EAAEK,MAAM,CAACL,MARF;AASbQ,kBAAAA,IAAI,EAAE,QATO;AAUbP,kBAAAA,WAAW,EAAEI,MAAM,CAACJ,WAVP;AAWbC,kBAAAA,WAAW,EAAEG,MAAM,CAACH,WAXP;AAYbC,kBAAAA,UAAU,EAAEE,MAAM,CAACF,UAZN;AAabC,kBAAAA,SAAS,EAATA,SAba;AAcb1B,kBAAAA,OAAO,EAAPA;AAda,iBAJP;;AAoBR,oBAAI;AACFhB,kBAAAA,MAAM,CAAC6C,MAAD,CAAN;AACA5E,kBAAAA,iBAAiB,CAAC,IAAD,CAAjB;AACD,iBAHD,CAGE,OAAO8E,GAAP,EAAY;AACZ,sBAAIA,GAAJ,EAAS;AACPlE,oBAAAA,cAAc,CAACkE,GAAD,CAAd;AACD;AACF;;AAEKC,gBAAAA,MA7BE,GA6BO;AACb5E,kBAAAA,UAAU,EAAEuE,MAAM,CAACjE,uBADN;AAEbA,kBAAAA,uBAAuB,EAAEiE,MAAM,CAACvE,UAFnB;AAGbN,kBAAAA,UAAU,EAAEA,UAHC;AAIboE,kBAAAA,QAAQ,EAAES,MAAM,CAACT,QAJJ;AAKbC,kBAAAA,SAAS,EAAEQ,MAAM,CAACR,SAAP,KAAqB,EAArB,GAA0B,IAA1B,GAAiCQ,MAAM,CAACR,SALtC;AAMbC,kBAAAA,YAAY,EAAEO,MAAM,CAACP,YANR;AAObC,kBAAAA,YAAY,EAAEM,MAAM,CAACN,YAPR;AAQbC,kBAAAA,MAAM,EAAEK,MAAM,CAACL,MARF;AASbQ,kBAAAA,IAAI,EAAE,QATO;AAUbP,kBAAAA,WAAW,EAAEI,MAAM,CAACJ,WAVP;AAWbC,kBAAAA,WAAW,EAAEG,MAAM,CAACH,WAXP;AAYbC,kBAAAA,UAAU,EAAEE,MAAM,CAACF,UAZN;AAabC,kBAAAA,SAAS,EAATA,SAba;AAcb1B,kBAAAA,OAAO,EAAPA;AAda,iBA7BP;;AA6CR,oBAAI;AACFhB,kBAAAA,MAAM,CAACgD,MAAD,CAAN;AACA7E,kBAAAA,iBAAiB,CAAC,IAAD,CAAjB;AACD,iBAHD,CAGE,OAAO4E,GAAP,EAAY;AACZ,sBAAIA,GAAJ,EAAS;AACPlE,oBAAAA,cAAc,CAACkE,GAAD,CAAd;AACD;AACF;;AAEDE,gBAAAA,UAAU,CAAC,YAAM;AACfhF,kBAAAA,iBAAiB,CAAC,KAAD,CAAjB;AACAE,kBAAAA,iBAAiB,CAAC,KAAD,CAAjB;AACAQ,kBAAAA,0BAA0B,CAAC,IAAD,CAA1B;AACAN,kBAAAA,aAAa,CAAC,IAAD,CAAb;AACD,iBALS,EAKP,IALO,CAAV;AAMAuE,gBAAAA,OAAO,CAACM,SAAR;;AA5DQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAF;;AAAA;AAAA;AAAA;AAAA,OAjBV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAgFG;AAAA,QAAGC,YAAH,SAAGA,YAAH;AAAA,QAAiBC,MAAjB,SAAiBA,MAAjB;AAAA,QAAyBC,OAAzB,SAAyBA,OAAzB;AAAA,QAAkCV,MAAlC,SAAkCA,MAAlC;AAAA,WACC,MAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAK,MAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAK,MAAA,SAAS,EAAC,wCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AACE,MAAA,SAAS,EAAC,8BADZ;AAEE,MAAA,OAAO,EAAC,cAFV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADF,EAOE,MAAC,KAAD;AACE,MAAA,SAAS,EAAC,mBADZ;AAEE,MAAA,IAAI,EAAC,cAFP;AAGE,MAAA,WAAW,EAAC,eAHd;AAIE,MAAA,YAAY,EAAC,IAJf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAPF,EAaGS,MAAM,CAAChB,YAAP,IAAuBiB,OAAO,CAACjB,YAA/B,GACC;AAAK,MAAA,SAAS,EAAC,mDAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGgB,MAAM,CAAChB,YADV,CADD,GAIG,IAjBN,CADF,EAoBE;AAAK,MAAA,SAAS,EAAC,wCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AACE,MAAA,SAAS,EAAC,8BADZ;AAEE,MAAA,OAAO,EAAC,YAFV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CADF,EAOE,MAAC,KAAD;AACE,MAAA,SAAS,EAAC,oBADZ;AAEE,MAAA,SAAS,EAAE3F,YAFb;AAGE,MAAA,OAAO,EAAEgB,SAHX;AAIE,MAAA,IAAI,EAAC,YAJP;AAKE,MAAA,YAAY,EAAE+D,sBALhB;AAME,MAAA,WAAW,EAAC,iBANd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAPF,EAeG4B,MAAM,CAAChF,UAAP,IAAqBiF,OAAO,CAACjF,UAA7B,GACC;AAAK,MAAA,SAAS,EAAC,mDAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGgF,MAAM,CAAChF,UADV,CADD,GAIG,IAnBN,CApBF,EAyCE;AAAK,MAAA,SAAS,EAAC,wCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AACE,MAAA,SAAS,EAAC,8BADZ;AAEE,MAAA,OAAO,EAAC,yBAFV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iDADF,EAOE,MAAC,KAAD;AACE,MAAA,SAAS,EAAC,oBADZ;AAEE,MAAA,SAAS,EAAE3B,YAFb;AAGE,MAAA,OAAO,EAAEkB,sBAHX;AAIE,MAAA,YAAY,EAAE+D,mCAJhB;AAKE,MAAA,IAAI,EAAC,yBALP;AAME,MAAA,WAAW,EAAC,iBANd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAPF,EAeG0B,MAAM,CAAC1E,uBAAP,IACD2E,OAAO,CAAC3E,uBADP,GAEC;AAAK,MAAA,SAAS,EAAC,mDAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG0E,MAAM,CAAC1E,uBADV,CAFD,GAKG,IApBN,CAzCF,EA+DE;AAAK,MAAA,SAAS,EAAC,wCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AACE,MAAA,SAAS,EAAC,8BADZ;AAEE,MAAA,OAAO,EAAC,YAFV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADF,EAOE,MAAC,UAAD;AACE,MAAA,QAAQ,EAAEZ,UADZ;AAEE,MAAA,QAAQ,EAAE,kBAACwF,IAAD,EAAU;AAClBlC,QAAAA,OAAO,CAACC,GAAR,CAAYiC,IAAZ,GAAmBvF,aAAa,CAACuF,IAAD,CAAhC;AACD,OAJH;AAKE,MAAA,SAAS,EAAC,mBALZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAPF,CA/DF,EA+EE;AAAK,MAAA,SAAS,EAAC,wCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AACE,MAAA,SAAS,EAAC,8BADZ;AAEE,MAAA,OAAO,EAAC,UAFV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,EAQE,MAAC,KAAD;AACE,MAAA,SAAS,EAAC,mBADZ;AAEE,MAAA,IAAI,EAAC,UAFP;AAGE,MAAA,WAAW,EAAC,cAHd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MARF,EAaGF,MAAM,CAAClB,QAAP,IAAmBmB,OAAO,CAACnB,QAA3B,GACC;AAAK,MAAA,SAAS,EAAC,mDAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGkB,MAAM,CAAClB,QADV,CADD,GAIG,IAjBN,CA/EF,EAkGE;AAAK,MAAA,SAAS,EAAC,wCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AACE,MAAA,SAAS,EAAC,8BADZ;AAEE,MAAA,OAAO,EAAC,WAFV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,EAQE,MAAC,KAAD;AACE,MAAA,SAAS,EAAC,mBADZ;AAEE,MAAA,IAAI,EAAC,WAFP;AAGE,MAAA,WAAW,EAAC,YAHd;AAIE,MAAA,IAAI,EAAC,QAJP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MARF,CAlGF,EAiHE;AAAK,MAAA,SAAS,EAAC,+CAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AACE,MAAA,SAAS,EAAC,mCADZ;AAEE,MAAA,IAAI,EAAC,cAFP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADF,EAOE,MAAC,KAAD;AACE,MAAA,SAAS,EAAC,mBADZ;AAEE,MAAA,IAAI,EAAC,cAFP;AAGE,MAAA,WAAW,EAAC,eAHd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAPF,EAYGkB,MAAM,CAACf,YAAP,IAAuBgB,OAAO,CAAChB,YAA/B,GACC;AAAK,MAAA,SAAS,EAAC,mDAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGe,MAAM,CAACf,YADV,CADD,GAIG,IAhBN,CAjHF,EAmIE;AAAK,MAAA,SAAS,EAAC,wCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AACE,MAAA,SAAS,EAAC,8BADZ;AAEE,MAAA,OAAO,EAAC,QAFV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,EAOE,MAAC,KAAD;AACE,MAAA,SAAS,EAAC,mBADZ;AAEE,MAAA,IAAI,EAAC,QAFP;AAGE,MAAA,WAAW,EAAC,QAHd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAPF,EAYGe,MAAM,CAACG,OAAP,IAAkBF,OAAO,CAACE,OAA1B,GACC;AAAK,MAAA,SAAS,EAAC,mDAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGH,MAAM,CAACG,OADV,CADD,GAIG,IAhBN,CAnIF,EAqJE;AAAK,MAAA,SAAS,EAAC,wCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AACE,MAAA,SAAS,EAAC,8BADZ;AAEE,MAAA,OAAO,EAAC,aAFV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,EAOE,MAAC,KAAD;AACE,MAAA,SAAS,EAAC,mBADZ;AAEE,MAAA,IAAI,EAAC,aAFP;AAGE,MAAA,WAAW,EAAC,cAHd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAPF,EAYGH,MAAM,CAACb,WAAP,IAAsBc,OAAO,CAACd,WAA9B,GACC;AAAK,MAAA,SAAS,EAAC,mDAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGa,MAAM,CAACb,WADV,CADD,GAIG,IAhBN,CArJF,EAuKE;AAAK,MAAA,SAAS,EAAC,wCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AACE,MAAA,SAAS,EAAC,8BADZ;AAEE,MAAA,OAAO,EAAC,aAFV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,EAOE,MAAC,KAAD;AACE,MAAA,SAAS,EAAC,mBADZ;AAEE,MAAA,IAAI,EAAC,aAFP;AAGE,MAAA,IAAI,EAAC,QAHP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAPF,EAYGa,MAAM,CAACZ,WAAP,IAAsBa,OAAO,CAACb,WAA9B,GACC;AAAK,MAAA,SAAS,EAAC,mDAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGY,MAAM,CAACZ,WADV,CADD,GAIG,IAhBN,CAvKF,EAyLE;AAAK,MAAA,SAAS,EAAC,wCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AACE,MAAA,SAAS,EAAC,8BADZ;AAEE,MAAA,OAAO,EAAC,YAFV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADF,EAOE,MAAC,KAAD;AACE,MAAA,SAAS,EAAC,mBADZ;AAEE,MAAA,IAAI,EAAC,YAFP;AAGE,MAAA,IAAI,EAAC,QAHP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAPF,EAYGY,MAAM,CAACX,UAAP,IAAqBY,OAAO,CAACZ,UAA7B,GACC;AAAK,MAAA,SAAS,EAAC,mDAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGW,MAAM,CAACX,UADV,CADD,GAIG,IAhBN,CAzLF,EA2ME;AAAK,MAAA,SAAS,EAAC,wCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AACE,MAAA,SAAS,EAAC,8BADZ;AAEE,MAAA,OAAO,EAAC,WAFV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,EAOE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGE,MAAM,CAACH,WAAP,IAAsBG,MAAM,CAACF,UAA7B,GACG,CAACE,MAAM,CAACH,WAAP,GAAqBG,MAAM,CAACF,UAA7B,EAAyCe,OAAzC,CACE,CADF,CADH,GAIG,gBALN,CADF,CAPF,CA3MF,EA4NE;AAAK,MAAA,SAAS,EAAC,wCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AACE,MAAA,SAAS,EAAC,8BADZ;AAEE,MAAA,OAAO,EAAC,SAFV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,EAOE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGb,MAAM,CAACH,WAAP,IAAsBG,MAAM,CAACF,UAA7B,GACG,CACE,CAACE,MAAM,CAACH,WAAP,GAAqBG,MAAM,CAACF,UAA7B,IACA,IAFF,EAGEe,OAHF,CAGU,CAHV,CADH,GAKG,gBANN,CADF,CAPF,CA5NF,EA+OE;AAAK,MAAA,SAAS,EAAC,2BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AACE,MAAA,SAAS,EAAC,gFADZ;AAEE,MAAA,OAAO,EAAE;AAAA,eAAMhG,MAAM,CAACiG,IAAP,EAAN;AAAA,OAFX;AAGE,MAAA,IAAI,EAAC,QAHP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,EAQE;AACE,MAAA,SAAS,EAAC,gGADZ;AAEE,MAAA,IAAI,EAAC,QAFP;AAGE,MAAA,QAAQ,EACNN,YAAY,IACX7E,yBAAyB,IACxBA,yBAAyB,CAACsC,YAA1B,IAA0C,CAF5C,IAGCpC,kBAAkB,IACjBA,kBAAkB,CAACoC,YAAnB,GAAkC,IARxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBARF,CA/OF,CADF,CADD;AAAA,GAhFH,CADF,EA4VGhC,WAAW,GACV;AAAK,IAAA,SAAS,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGwC,OAAO,CAACC,GAAR,CAAYzC,WAAZ,CADH,CADU,GAKV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAjWJ,EAmWGZ,cAAc,IAAIE,cAAlB,GACC;AAAK,IAAA,SAAS,EAAC,oDAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAK,IAAA,SAAS,EAAC,uDAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAM,IAAA,SAAS,EAAC,MAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCADF,CADF,CADD,GAOC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IA1WJ,CADF,EA8WE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAK,IAAA,SAAS,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAK,IAAA,SAAS,EAAC,oDAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAI,IAAA,SAAS,EAAC,uBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADF,CADF,EAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGY,cAAc,CAACa,MAAf,GACCb,cAAc,CAAC8C,GAAf,CAAmB,UAAC8B,MAAD;AAAA,WACjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAQ1G,cAAc,CAAC0G,MAAM,CAACxC,EAAR,EAAY,CAAZ,CAAtB,gBACEwC,MAAM,CAACtB,YADT,EADiB;AAAA,GAAnB,CADD,GAOC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SARJ,CADF,CAJF,CADF,EAmBE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAK,IAAA,SAAS,EAAC,sCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8BADF,CADF,EAIG9D,yBAAyB,GACxB;AAAK,IAAA,SAAS,EAAC,qCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAOA,yBAAyB,CAACkC,cAAjC,CADF,CAFF,EAKE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAOlC,yBAAyB,CAACoC,aAAjC,CAFF,CALF,EASE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADF,EAEE;AACE,IAAA,SAAS,YACPpC,yBAAyB,CAACsC,YAA1B,GAAyC,EAAzC,GACI,cADJ,GAEI,eAHG,CADX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAOGtC,yBAAyB,CAACsC,YAA1B,CAAuC4C,OAAvC,CAA+C,CAA/C,CAPH,CAFF,CATF,CADwB,GAuBtB,IA3BN,EA4BGhF,kBAAkB,GACjB;AAAK,IAAA,SAAS,EAAC,2CAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAOA,kBAAkB,CAACgC,cAA1B,CADF,CAFF,EAKE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAOhC,kBAAkB,CAACkC,aAA1B,CAFF,CALF,EASE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADF,EAEE;AACE,IAAA,SAAS,YACPlC,kBAAkB,CAACoC,YAAnB,GAAkC,EAAlC,GACI,cADJ,GAEI,eAHG,CADX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAOGpC,kBAAkB,CAACoC,YAAnB,CAAgC4C,OAAhC,CAAwC,CAAxC,CAPH,CAFF,CATF,CADiB,GAuBf,IAnDN,CAnBF,CA9WF,CAJF,CADF,EA8bE,MAAC,kBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IA9bF,CADF;AAkcD,CA/mBD;;GAAMlG,Y;UACeH,a,EACJb,S,EAiB8BY,W,EA4BbD,Q;;;KA/C5BK,Y;;AAuoBN,eAAeA,YAAf","sourcesContent":["import { Formik, Field, Form } from \"formik\";\nimport { useRouter } from \"next/router\";\nimport { useState, useEffect } from \"react\";\nimport { FormikSelect } from \"../../components/formikSelectTickets\";\nimport Layout from \"../../components/layout\";\nimport { API, withSSRContext } from \"aws-amplify\";\nimport { createTicket } from \"../../src/graphql/mutations.ts\";\nimport { listContracts } from \"../../src/graphql/queries.ts\";\nimport { ticketsByContract } from \"../../src/graphql/customQueries\";\nimport DatePicker from \"react-datepicker\";\nimport { truncateString } from \"../../utils\";\nimport { useQuery, useMutation, useQueryCache } from \"react-query\";\nimport { ReactQueryDevtools } from \"react-query-devtools\";\nimport { CreateTicketSchema } from \"../../components/validationSchema\";\n\nconst CreateTicket = () => {\n  const queryCache = useQueryCache();\n  const router = useRouter();\n  const [contracts, setContracts] = useState([]);\n  const [correspondingContracts, setCorrespondingContracts] = useState([]);\n  const [ticketDate, setTicketDate] = useState(new Date());\n  const [ticketSuccess1, setTicketSuccess1] = useState(false);\n  const [ticketSuccess2, setTicketSuccess2] = useState(false);\n  const [contractId, setContractId] = useState(null);\n  const [\n    purchasedFromQtyRemaining,\n    setPurchasedFromQuantityRemaining,\n  ] = useState(null);\n  const [soldToQtyRemaining, setSoldToQuantityRemaining] = useState(null);\n  const [correspondingContractId, setCorrespondingContractId] = useState(null);\n  const [ticketError, setTicketError] = useState(null);\n\n  const [createdTickets, setCreatedTickets] = useState([]);\n\n  const [mutate, { data, error, isSuccess }] = useMutation(\n    async (input) => {\n      const { data: ticketData } = await API.graphql({\n        query: createTicket,\n        variables: {\n          input,\n        },\n      });\n      return ticketData;\n    },\n    {\n      onSuccess: ({ createTicket }) => {\n        let ticketsCreated = [...createdTickets];\n        ticketsCreated.push(createTicket);\n\n        setCreatedTickets(ticketsCreated);\n        const lengthOfGroups = queryCache.getQueryData(\"tickets\").length;\n\n        let previousData = queryCache.getQueryData(\"tickets\");\n        previousData[lengthOfGroups - 1].items.push(createTicket);\n        return () => queryCache.setQueryData(\"tickets\", () => [previousData]);\n      },\n      onError: ({ ticketError }) => {\n        setTicketError(ticketError);\n      },\n    }\n  );\n\n  const { data: contractsData } = useQuery(\n    \"contracts\",\n    async () => {\n      const {\n        data: { listContracts: contractsData },\n      } = await API.graphql({\n        query: listContracts,\n        variables: {\n          limit: 3000,\n        },\n      });\n      return contractsData;\n    },\n    {\n      cacheTime: 1000 * 60 * 20,\n    }\n  );\n\n  const getPurchasedFromTickets = async () => {\n    const {\n      data: {\n        ticketsByContract: { items: purchasedFromTickets },\n      },\n    } = await API.graphql({\n      query: ticketsByContract,\n      variables: {\n        contractId,\n        limit: 1000,\n      },\n    });\n    if (purchasedFromTickets.length > 0) {\n      const contractNumber = purchasedFromTickets[0].contract.contractNumber;\n      const contractedQty = purchasedFromTickets[0].contract.quantity;\n      const qtyRemaining =\n        contractedQty -\n        purchasedFromTickets.reduce((acc, cv) => acc + cv.netTons, 0);\n\n      setPurchasedFromQuantityRemaining({\n        contractNumber,\n        contractedQty,\n        qtyRemaining,\n      });\n    } else {\n      const contract = contractsData.items.findIndex(\n        (contract) => contract.id === contractId\n      );\n      const myContract = contractsData.items[contract];\n      console.log(myContract);\n      setPurchasedFromQuantityRemaining({\n        contractNumber: myContract.contractNumber,\n        contractedQty: myContract.quantity,\n        qtyRemaining: myContract.quantity,\n      });\n    }\n  };\n\n  const getSoldToTickets = async () => {\n    const {\n      data: {\n        ticketsByContract: { items: soldToTickets },\n      },\n    } = await API.graphql({\n      query: ticketsByContract,\n      variables: {\n        contractId: correspondingContractId,\n        limit: 1000,\n      },\n    });\n\n    if (soldToTickets.length > 0) {\n      const contractNumber = soldToTickets[0].contract.contractNumber;\n      const contractedQty = soldToTickets[0].contract.quantity;\n      const qtyRemaining =\n        contractedQty - soldToTickets.reduce((acc, cv) => acc + cv.netTons, 0);\n\n      setSoldToQuantityRemaining({\n        contractNumber,\n        contractedQty,\n        qtyRemaining,\n      });\n    } else {\n      const contract = contractsData.items.findIndex(\n        (contract) => contract.id === correspondingContractId\n      );\n      const myContract = contractsData.items[contract];\n      console.log(myContract);\n      setSoldToQuantityRemaining({\n        contractNumber: myContract.contractNumber,\n        contractedQty: myContract.quantity,\n        qtyRemaining: myContract.quantity,\n      });\n    }\n  };\n\n  const handleContractIdChange = (value) => {\n    setContractId(value);\n  };\n\n  const handleCorrespondingContractIdChange = (value) => {\n    console.log(value);\n    setCorrespondingContractId(value);\n  };\n\n  useEffect(() => {\n    if (contractsData) {\n      let options = [];\n      contractsData.items.map((c) => {\n        options.push({\n          value: c.id,\n          label: `${c.contractNumber} - ${c.contractTo.companyReportName} - ${c.contractType}`,\n        });\n      });\n      setContracts(options);\n      setCorrespondingContracts(options);\n    }\n  }, [contractsData]);\n\n  useEffect(() => {\n    if (contractId) {\n      getPurchasedFromTickets();\n    }\n    if (correspondingContractId) {\n      getSoldToTickets();\n    }\n  }, [contractId, correspondingContractId]);\n\n  return (\n    <Layout>\n      <div>\n        <div className=\"text-center w-1/2 mx-auto py-6 text-2xl font-bold\">\n          <h3>Create Ticket</h3>\n        </div>\n        <div className=\"flex justify-around relative \">\n          <div className=\"w-1/2\">\n            <Formik\n              initialValues={{\n                contractId: \"\",\n                correspondingContractId: \"\",\n                ticketDate: ticketDate,\n                fieldNum: \"\",\n                baleCount: 0,\n                ticketNumber: \"\",\n                ladingNumber: \"\",\n                driver: \"\",\n                truckNumber: \"\",\n                grossWeight: 0,\n                tareWeight: 0,\n                netWeight: 0,\n                netTons: 0,\n              }}\n              validationSchema={CreateTicketSchema}\n              onSubmit={async (values, actions) => {\n                let netWeight = values.grossWeight - values.tareWeight;\n                let netTons = netWeight / 2000;\n\n                const input1 = {\n                  contractId: values.contractId,\n                  correspondingContractId: values.correspondingContractId,\n                  ticketDate: ticketDate,\n                  fieldNum: values.fieldNum,\n                  baleCount: values.baleCount === \"\" ? null : values.baleCount,\n                  ticketNumber: values.ticketNumber,\n                  ladingNumber: values.ladingNumber,\n                  driver: values.driver,\n                  type: \"Ticket\",\n                  truckNumber: values.truckNumber,\n                  grossWeight: values.grossWeight,\n                  tareWeight: values.tareWeight,\n                  netWeight,\n                  netTons,\n                };\n                try {\n                  mutate(input1);\n                  setTicketSuccess1(true);\n                } catch (err) {\n                  if (err) {\n                    setTicketError(err);\n                  }\n                }\n\n                const input2 = {\n                  contractId: values.correspondingContractId,\n                  correspondingContractId: values.contractId,\n                  ticketDate: ticketDate,\n                  fieldNum: values.fieldNum,\n                  baleCount: values.baleCount === \"\" ? null : values.baleCount,\n                  ticketNumber: values.ticketNumber,\n                  ladingNumber: values.ladingNumber,\n                  driver: values.driver,\n                  type: \"Ticket\",\n                  truckNumber: values.truckNumber,\n                  grossWeight: values.grossWeight,\n                  tareWeight: values.tareWeight,\n                  netWeight,\n                  netTons,\n                };\n                try {\n                  mutate(input2);\n                  setTicketSuccess2(true);\n                } catch (err) {\n                  if (err) {\n                    setTicketError(err);\n                  }\n                }\n\n                setTimeout(() => {\n                  setTicketSuccess1(false);\n                  setTicketSuccess2(false);\n                  setCorrespondingContractId(null);\n                  setContractId(null);\n                }, 2000);\n                actions.resetForm();\n              }}\n            >\n              {({ isSubmitting, errors, touched, values }) => (\n                <Form>\n                  <div className=\"w-full mx-auto\">\n                    <div className=\"flex justify-between items-center mb-4\">\n                      <label\n                        className=\"text-gray-900 w-1/4 md:w-1/2\"\n                        htmlFor=\"ticketNumber\"\n                      >\n                        Ticket Number\n                      </label>\n                      <Field\n                        className=\"form-input w-full\"\n                        name=\"ticketNumber\"\n                        placeholder=\"Ticket Number\"\n                        autoComplete=\"on\"\n                      />\n                      {errors.ticketNumber && touched.ticketNumber ? (\n                        <div className=\"text-red-700 ml-2 bg-red-200 px-2 py-1 rounded-sm\">\n                          {errors.ticketNumber}\n                        </div>\n                      ) : null}\n                    </div>\n                    <div className=\"flex justify-between items-center mb-4\">\n                      <label\n                        className=\"text-gray-900 w-1/4 md:w-1/2\"\n                        htmlFor=\"contractId\"\n                      >\n                        Contract Number - Purchased From\n                      </label>\n                      <Field\n                        className=\"form-select w-full\"\n                        component={FormikSelect}\n                        options={contracts}\n                        name=\"contractId\"\n                        handleChange={handleContractIdChange}\n                        placeholder=\"Contract Number\"\n                      />\n                      {errors.contractId && touched.contractId ? (\n                        <div className=\"text-red-700 ml-2 bg-red-200 px-2 py-1 rounded-sm\">\n                          {errors.contractId}\n                        </div>\n                      ) : null}\n                    </div>\n                    <div className=\"flex justify-between items-center mb-4\">\n                      <label\n                        className=\"text-gray-900 w-1/4 md:w-1/2\"\n                        htmlFor=\"correspondingContractId\"\n                      >\n                        Corresponding Contract Number - Sold To\n                      </label>\n                      <Field\n                        className=\"form-select w-full\"\n                        component={FormikSelect}\n                        options={correspondingContracts}\n                        handleChange={handleCorrespondingContractIdChange}\n                        name=\"correspondingContractId\"\n                        placeholder=\"Contract Number\"\n                      />\n                      {errors.correspondingContractId &&\n                      touched.correspondingContractId ? (\n                        <div className=\"text-red-700 ml-2 bg-red-200 px-2 py-1 rounded-sm\">\n                          {errors.correspondingContractId}\n                        </div>\n                      ) : null}\n                    </div>\n                    <div className=\"flex justify-between items-center mb-4\">\n                      <label\n                        className=\"text-gray-900 w-1/4 md:w-1/2\"\n                        htmlFor=\"ticketDate\"\n                      >\n                        Ticket Date\n                      </label>\n                      <DatePicker\n                        selected={ticketDate}\n                        onChange={(date) => {\n                          console.log(date), setTicketDate(date);\n                        }}\n                        className=\"form-input w-full\"\n                      />\n                    </div>\n\n                    <div className=\"flex justify-between items-center mb-4\">\n                      <label\n                        className=\"text-gray-900 w-1/4 md:w-1/2\"\n                        htmlFor=\"fieldNum\"\n                      >\n                        Field Number\n                      </label>\n\n                      <Field\n                        className=\"form-input w-full\"\n                        name=\"fieldNum\"\n                        placeholder=\"Field Number\"\n                      />\n                      {errors.fieldNum && touched.fieldNum ? (\n                        <div className=\"text-red-700 ml-2 bg-red-200 px-2 py-1 rounded-sm\">\n                          {errors.fieldNum}\n                        </div>\n                      ) : null}\n                    </div>\n                    <div className=\"flex justify-between items-center mb-4\">\n                      <label\n                        className=\"text-gray-900 w-1/4 md:w-1/2\"\n                        htmlFor=\"baleCount\"\n                      >\n                        Bale Count\n                      </label>\n\n                      <Field\n                        className=\"form-input w-full\"\n                        name=\"baleCount\"\n                        placeholder=\"Bale Count\"\n                        type=\"number\"\n                      />\n                    </div>\n                    <div className=\"flex justify-between items-center mb-4 w-full\">\n                      <label\n                        className=\"text-gray-900 w-1/4 md:w-1/2 pr-4\"\n                        name=\"ladingNumber\"\n                      >\n                        Lading Number\n                      </label>\n                      <Field\n                        className=\"form-input w-full\"\n                        name=\"ladingNumber\"\n                        placeholder=\"Lading Number\"\n                      />\n                      {errors.ladingNumber && touched.ladingNumber ? (\n                        <div className=\"text-red-700 ml-2 bg-red-200 px-2 py-1 rounded-sm\">\n                          {errors.ladingNumber}\n                        </div>\n                      ) : null}\n                    </div>\n                    <div className=\"flex justify-between items-center mb-4\">\n                      <label\n                        className=\"w-1/4 text-gray-900 md:w-1/2\"\n                        htmlFor=\"driver\"\n                      >\n                        Driver\n                      </label>\n                      <Field\n                        className=\"form-input w-full\"\n                        name=\"driver\"\n                        placeholder=\"Driver\"\n                      />\n                      {errors.drivers && touched.drivers ? (\n                        <div className=\"text-red-700 ml-2 bg-red-200 px-2 py-1 rounded-sm\">\n                          {errors.drivers}\n                        </div>\n                      ) : null}\n                    </div>\n                    <div className=\"flex justify-between items-center mb-4\">\n                      <label\n                        className=\"w-1/4 text-gray-900 md:w-1/2\"\n                        htmlFor=\"truckNumber\"\n                      >\n                        Truck Number\n                      </label>\n                      <Field\n                        className=\"form-input w-full\"\n                        name=\"truckNumber\"\n                        placeholder=\"Truck Number\"\n                      />\n                      {errors.truckNumber && touched.truckNumber ? (\n                        <div className=\"text-red-700 ml-2 bg-red-200 px-2 py-1 rounded-sm\">\n                          {errors.truckNumber}\n                        </div>\n                      ) : null}\n                    </div>\n                    <div className=\"flex justify-between items-center mb-4\">\n                      <label\n                        className=\"w-1/4 text-gray-900 md:w-1/2\"\n                        htmlFor=\"grossWeight\"\n                      >\n                        Gross Weight\n                      </label>\n                      <Field\n                        className=\"form-input w-full\"\n                        name=\"grossWeight\"\n                        type=\"number\"\n                      />\n                      {errors.grossWeight && touched.grossWeight ? (\n                        <div className=\"text-red-700 ml-2 bg-red-200 px-2 py-1 rounded-sm\">\n                          {errors.grossWeight}\n                        </div>\n                      ) : null}\n                    </div>\n                    <div className=\"flex justify-between items-center mb-4\">\n                      <label\n                        className=\"w-1/4 text-gray-900 md:w-1/2\"\n                        htmlFor=\"tareWeight\"\n                      >\n                        Tare Weight\n                      </label>\n                      <Field\n                        className=\"form-input w-full\"\n                        name=\"tareWeight\"\n                        type=\"number\"\n                      />\n                      {errors.tareWeight && touched.tareWeight ? (\n                        <div className=\"text-red-700 ml-2 bg-red-200 px-2 py-1 rounded-sm\">\n                          {errors.tareWeight}\n                        </div>\n                      ) : null}\n                    </div>\n                    <div className=\"flex justify-between items-center mb-4\">\n                      <label\n                        className=\"w-1/4 text-gray-900 md:w-1/2\"\n                        htmlFor=\"netWeight\"\n                      >\n                        Net Weight\n                      </label>\n                      <div>\n                        <span>\n                          {values.grossWeight && values.tareWeight\n                            ? (values.grossWeight - values.tareWeight).toFixed(\n                                2\n                              )\n                            : \"Not calculated\"}\n                        </span>\n                      </div>\n                    </div>\n                    <div className=\"flex justify-between items-center mb-4\">\n                      <label\n                        className=\"w-1/4 text-gray-900 md:w-1/2\"\n                        htmlFor=\"netTons\"\n                      >\n                        Net Tons\n                      </label>\n                      <div>\n                        <span>\n                          {values.grossWeight && values.tareWeight\n                            ? (\n                                (values.grossWeight - values.tareWeight) /\n                                2000\n                              ).toFixed(2)\n                            : \"Not calculated\"}\n                        </span>\n                      </div>\n                    </div>\n\n                    <div className=\"flex justify-center mt-12\">\n                      <button\n                        className=\"px-3 py-2 border border-red-500 shadow hover:bg-red-500 hover:text-white mr-12\"\n                        onClick={() => router.back()}\n                        type=\"button\"\n                      >\n                        Cancel\n                      </button>\n                      <button\n                        className=\"px-3 py-2 border border-gray-800 shadow hover:bg-gray-800 hover:text-white disabled:opacity-25\"\n                        type=\"submit\"\n                        disabled={\n                          isSubmitting ||\n                          (purchasedFromQtyRemaining &&\n                            purchasedFromQtyRemaining.qtyRemaining <= 0) ||\n                          (soldToQtyRemaining &&\n                            soldToQtyRemaining.qtyRemaining < 0.01)\n                        }\n                      >\n                        Submit\n                      </button>\n                    </div>\n                  </div>\n                </Form>\n              )}\n            </Formik>\n            {ticketError ? (\n              <div className=\"bg-red-600 text-white\">\n                {console.log(ticketError)}\n              </div>\n            ) : (\n              <div></div>\n            )}\n            {ticketSuccess1 && ticketSuccess2 ? (\n              <div className=\"absolute inset-0 flex items-center justify-center \">\n                <div className=\" w-64 h-24 text-white bg-green-500 bg-opacity-75 py-8\">\n                  <span className=\"px-4\">Successfully created ticet.</span>\n                </div>\n              </div>\n            ) : (\n              <div></div>\n            )}\n          </div>\n          <div>\n            <div className=\"w-2/12\">\n              <div className=\"border-b-4 w-full border-gray-600 mb-3 text-center\">\n                <h6 className=\"text-gray-900 text-lg\">Created Tickets</h6>\n              </div>\n              <div>\n                <ul>\n                  {createdTickets.length ? (\n                    createdTickets.map((ticket) => (\n                      <li>{`${truncateString(ticket.id, 7)} - ${\n                        ticket.ticketNumber\n                      }`}</li>\n                    ))\n                  ) : (\n                    <div>0</div>\n                  )}\n                </ul>\n              </div>\n            </div>\n            <div>\n              <div className=\"mt-8 border-b-4 border-gray-600 mb-2\">\n                <h6>Chosen Contract Values</h6>\n              </div>\n              {purchasedFromQtyRemaining ? (\n                <div className=\"bg-blue-300 bg-opacity-50 px-2 py-2\">\n                  <p>Purchased From:</p>\n                  <div>\n                    <span>{purchasedFromQtyRemaining.contractNumber}</span>\n                  </div>\n                  <div>\n                    <span>Contract Qty: </span>\n                    <span>{purchasedFromQtyRemaining.contractedQty}</span>\n                  </div>\n                  <div>\n                    <span>Qty Remaining: </span>\n                    <span\n                      className={`${\n                        purchasedFromQtyRemaining.qtyRemaining < 25\n                          ? \"text-red-500\"\n                          : \"text-gray-900\"\n                      }`}\n                    >\n                      {purchasedFromQtyRemaining.qtyRemaining.toFixed(2)}\n                    </span>\n                  </div>\n                </div>\n              ) : null}\n              {soldToQtyRemaining ? (\n                <div className=\"bg-green-300 bg-opacity-50 px-2 py-2 mt-2\">\n                  <p>Sold To:</p>\n                  <div>\n                    <span>{soldToQtyRemaining.contractNumber}</span>\n                  </div>\n                  <div>\n                    <span>Contract Qty: </span>\n                    <span>{soldToQtyRemaining.contractedQty}</span>\n                  </div>\n                  <div>\n                    <span>Qty Remaining: </span>\n                    <span\n                      className={`${\n                        soldToQtyRemaining.qtyRemaining < 25\n                          ? \"text-red-500\"\n                          : \"text-gray-900\"\n                      }`}\n                    >\n                      {soldToQtyRemaining.qtyRemaining.toFixed(2)}\n                    </span>\n                  </div>\n                </div>\n              ) : null}\n            </div>\n          </div>\n        </div>\n      </div>\n      <ReactQueryDevtools />\n    </Layout>\n  );\n};\n\nexport async function getServerSideProps({ req, res }) {\n  const { Auth } = withSSRContext({ req });\n  try {\n    const user = await Auth.currentAuthenticatedUser();\n\n    return {\n      props: {\n        authenticated: true,\n        username: user.username,\n      },\n    };\n  } catch (err) {\n    res.writeHead(302, { Location: \"/sign-in\" });\n    res.end();\n    return {\n      props: {\n        authenticated: false,\n      },\n    };\n  }\n}\n\nexport default CreateTicket;\n"]},"metadata":{},"sourceType":"module"}