{"ast":null,"code":"var _jsxFileName = \"/Users/gregleeper/jds/pages/contracts/index.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Layout from \"../../components/layout\";\nimport { useMemo, useEffect, useState } from \"react\";\nimport { API, withSSRContext } from \"aws-amplify\";\nimport { listContracts } from \"../../src/graphql/queries.ts\";\nimport Link from \"next/link\";\nimport Table from \"../../components/table\";\nimport moment from \"moment\";\nimport { formatMoney } from \"../../utils\";\nimport { useQuery, QueryCache } from \"react-query\";\n\nconst Contracts = () => {\n  const {\n    0: contracts,\n    1: setContracts\n  } = useState([]);\n  const {\n    data\n  } = useQuery(\"contracts\", async () => {\n    const {\n      data: {\n        listContracts: contractsData\n      }\n    } = await API.graphql({\n      query: listContracts,\n      variables: {\n        limit: 3000\n      }\n    });\n    return contractsData;\n  });\n  useEffect(() => {\n    if (data) {\n      setContracts(data.items);\n    }\n  }, [data]);\n  const columns = useMemo(() => [{\n    Header: \"Edit\",\n    accessor: \"id\",\n    Cell: ({\n      value\n    }) => __jsx(React.Fragment, null, __jsx(Link, {\n      href: \"/contracts/edit/[id]\",\n      as: `/contracts/edit/${value}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 13\n      }\n    }, __jsx(\"a\", {\n      className: \"text-blue-600 underline hover:text-blue-800 hover:no-underline mr-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40,\n        columnNumber: 15\n      }\n    }, \"Edit\")), __jsx(Link, {\n      href: \"/contracts/view/[id]\",\n      as: `/contracts/view/${value}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 44,\n        columnNumber: 13\n      }\n    }, __jsx(\"a\", {\n      className: \"text-blue-600 underline hover:text-blue-800 hover:no-underline\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 15\n      }\n    }, \"View\"))),\n    disableFilters: true\n  }, {\n    Header: \"Contract #\",\n    accessor: \"contractNumber\"\n  }, {\n    Header: \"Contract Type\",\n    accessor: \"contractType\"\n  }, {\n    Header: \"Vendor\",\n    accessor: \"contractTo.companyListingName\"\n  }, {\n    Header: \"Commodity\",\n    accessor: \"commodity.name\"\n  }, {\n    Header: \"Begin Date\",\n    accessor: \"beginDate\",\n    Cell: ({\n      value\n    }) => __jsx(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 11\n      }\n    }, moment(value).format(\"MMM Do, YYYY\"))\n  }, {\n    Header: \"End Date\",\n    accessor: \"endDate\",\n    Cell: ({\n      value\n    }) => __jsx(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 11\n      }\n    }, moment(value).format(\"MMM Do, YYYY\"))\n  }, {\n    Header: \"Status\",\n    accessor: \"contractState\"\n  }, {\n    Header: \"Quantity in Tons\",\n    accessor: \"quantity\",\n    disableFilters: true\n  }, {\n    Header: \"Contract Price\",\n    accessor: \"contractPrice\",\n    Cell: ({\n      value\n    }) => __jsx(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 30\n      }\n    }, formatMoney.format(value)),\n    disableFilters: true\n  }, {\n    Header: \"Sale Price\",\n    accessor: \"salePrice\",\n    Cell: ({\n      value\n    }) => __jsx(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 30\n      }\n    }, formatMoney.format(value)),\n    disableFilters: true\n  }, {\n    Header: \"Contract Purchase Value\",\n    accessor: \"\",\n    Cell: row => __jsx(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 11\n      }\n    }, formatMoney.format(row.row.values.quantity * row.row.values.contractPrice)),\n    disableFilters: true\n  }, {\n    Header: \"Contract Sale Value\",\n    accessor: \"\",\n    Cell: row => __jsx(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 11\n      }\n    }, formatMoney.format(row.row.values.quantity * row.row.values.salePrice)),\n    disableFilters: true\n  }], []);\n  return __jsx(Layout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    className: \"px-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    className: \"text-center w-1/2 mx-auto py-6 text-2xl font-bold\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 9\n    }\n  }, __jsx(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 11\n    }\n  }, \"Contracts\")), __jsx(\"div\", {\n    className: \"my-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 9\n    }\n  }, __jsx(Link, {\n    href: \"/contracts/create\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 11\n    }\n  }, __jsx(\"a\", {\n    className: \"px-3 py-2 border border-gray-800 shadow hover:bg-gray-800 hover:text-white\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 13\n    }\n  }, \"Create New\"))), __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 9\n    }\n  }, __jsx(Table, {\n    data: contracts,\n    columns: columns,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 11\n    }\n  }))));\n};\n\nexport async function getServerSideProps({\n  req,\n  res\n}) {\n  const {\n    Auth\n  } = withSSRContext({\n    req\n  });\n\n  try {\n    const user = await Auth.currentAuthenticatedUser();\n    return {\n      props: {\n        authenticated: true,\n        username: user.username\n      }\n    };\n  } catch (err) {\n    res.writeHead(302, {\n      Location: \"/sign-in\"\n    });\n    res.end();\n    return {\n      props: {\n        authenticated: false\n      }\n    };\n  }\n}\nexport default Contracts;","map":{"version":3,"sources":["/Users/gregleeper/jds/pages/contracts/index.js"],"names":["Layout","useMemo","useEffect","useState","API","withSSRContext","listContracts","Link","Table","moment","formatMoney","useQuery","QueryCache","Contracts","contracts","setContracts","data","contractsData","graphql","query","variables","limit","items","columns","Header","accessor","Cell","value","disableFilters","format","row","values","quantity","contractPrice","salePrice","getServerSideProps","req","res","Auth","user","currentAuthenticatedUser","props","authenticated","username","err","writeHead","Location","end"],"mappings":"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","sourcesContent":["import Layout from \"../../components/layout\";\nimport { useMemo, useEffect, useState } from \"react\";\nimport { API, withSSRContext } from \"aws-amplify\";\nimport { listContracts } from \"../../src/graphql/queries.ts\";\nimport Link from \"next/link\";\nimport Table from \"../../components/table\";\nimport moment from \"moment\";\nimport { formatMoney } from \"../../utils\";\nimport { useQuery, QueryCache } from \"react-query\";\n\nconst Contracts = () => {\n  const [contracts, setContracts] = useState([]);\n\n  const { data } = useQuery(\"contracts\", async () => {\n    const {\n      data: { listContracts: contractsData },\n    } = await API.graphql({\n      query: listContracts,\n      variables: {\n        limit: 3000,\n      },\n    });\n    return contractsData;\n  });\n\n  useEffect(() => {\n    if (data) {\n      setContracts(data.items);\n    }\n  }, [data]);\n\n  const columns = useMemo(\n    () => [\n      {\n        Header: \"Edit\",\n        accessor: \"id\",\n        Cell: ({ value }) => (\n          <>\n            <Link href=\"/contracts/edit/[id]\" as={`/contracts/edit/${value}`}>\n              <a className=\"text-blue-600 underline hover:text-blue-800 hover:no-underline mr-2\">\n                Edit\n              </a>\n            </Link>\n            <Link href=\"/contracts/view/[id]\" as={`/contracts/view/${value}`}>\n              <a className=\"text-blue-600 underline hover:text-blue-800 hover:no-underline\">\n                View\n              </a>\n            </Link>\n          </>\n        ),\n        disableFilters: true,\n      },\n      {\n        Header: \"Contract #\",\n        accessor: \"contractNumber\",\n      },\n      {\n        Header: \"Contract Type\",\n        accessor: \"contractType\",\n      },\n      {\n        Header: \"Vendor\",\n        accessor: \"contractTo.companyListingName\",\n      },\n      {\n        Header: \"Commodity\",\n        accessor: \"commodity.name\",\n      },\n      {\n        Header: \"Begin Date\",\n        accessor: \"beginDate\",\n        Cell: ({ value }) => (\n          <span>{moment(value).format(\"MMM Do, YYYY\")}</span>\n        ),\n      },\n      {\n        Header: \"End Date\",\n        accessor: \"endDate\",\n        Cell: ({ value }) => (\n          <span>{moment(value).format(\"MMM Do, YYYY\")}</span>\n        ),\n      },\n      {\n        Header: \"Status\",\n        accessor: \"contractState\",\n      },\n      {\n        Header: \"Quantity in Tons\",\n        accessor: \"quantity\",\n        disableFilters: true,\n      },\n      {\n        Header: \"Contract Price\",\n        accessor: \"contractPrice\",\n        Cell: ({ value }) => <span>{formatMoney.format(value)}</span>,\n        disableFilters: true,\n      },\n      {\n        Header: \"Sale Price\",\n        accessor: \"salePrice\",\n        Cell: ({ value }) => <span>{formatMoney.format(value)}</span>,\n        disableFilters: true,\n      },\n      {\n        Header: \"Contract Purchase Value\",\n        accessor: \"\",\n        Cell: (row) => (\n          <span>\n            {formatMoney.format(\n              row.row.values.quantity * row.row.values.contractPrice\n            )}\n          </span>\n        ),\n        disableFilters: true,\n      },\n      {\n        Header: \"Contract Sale Value\",\n        accessor: \"\",\n        Cell: (row) => (\n          <span>\n            {formatMoney.format(\n              row.row.values.quantity * row.row.values.salePrice\n            )}\n          </span>\n        ),\n        disableFilters: true,\n      },\n    ],\n    []\n  );\n\n  return (\n    <Layout>\n      <div className=\"px-6\">\n        <div className=\"text-center w-1/2 mx-auto py-6 text-2xl font-bold\">\n          <h3>Contracts</h3>\n        </div>\n        <div className=\"my-6\">\n          <Link href=\"/contracts/create\">\n            <a className=\"px-3 py-2 border border-gray-800 shadow hover:bg-gray-800 hover:text-white\">\n              Create New\n            </a>\n          </Link>\n        </div>\n        <div>\n          <Table data={contracts} columns={columns} />\n        </div>\n      </div>\n    </Layout>\n  );\n};\n\nexport async function getServerSideProps({ req, res }) {\n  const { Auth } = withSSRContext({ req });\n  try {\n    const user = await Auth.currentAuthenticatedUser();\n\n    return {\n      props: {\n        authenticated: true,\n        username: user.username,\n      },\n    };\n  } catch (err) {\n    res.writeHead(302, { Location: \"/sign-in\" });\n    res.end();\n    return {\n      props: {\n        authenticated: false,\n      },\n    };\n  }\n}\n\nexport default Contracts;\n"]},"metadata":{},"sourceType":"module"}